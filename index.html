<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>고독사 없는 따뜻한 세상 - 당신의 목소리에 귀 기울입니다</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* 다크 모드 테마 및 기본 스타일 */
        html, body {
            height: 100%; /* html, body가 화면 전체 높이를 차지하도록 */
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a; /* 어두운 배경 */
            color: #e0e0e0; /* 밝은 텍스트 */
            line-height: 1.6;
            overflow: hidden; /* 전체 페이지 스크롤 방지. 특정 영역만 스크롤되도록 */
            display: flex;
            flex-direction: column;
        }
        header {
            background-color: #2c3e50;
            color: #ffffff;
            padding: 2em 0 1em; /* 아래 패딩 줄임 */
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            flex-shrink: 0; /* 헤더가 줄어들지 않도록 */
        }
        header h1 {
            margin: 0;
            font-size: 3.2em; /* 더 크게 */
            letter-spacing: 1px;
            font-weight: bold; /* 더 굵게 */
        }
        .comfort-message {
            font-size: 1.5em; /* 위로의 메시지 크기 */
            font-weight: bold; /* 굵게 */
            color: #f1c40f; /* 강조 색상 */
            margin-top: 15px;
            padding: 0 20px;
        }

        /* 내비게이션 바 스타일 */
        nav {
            background-color: #34495e; /* 헤더보다 약간 밝은 색 */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            padding: 10px 0;
            text-align: center;
            z-index: 20; /* 다른 섹션 위에 오도록 */
            flex-shrink: 0; /* 네비게이션 바가 줄어들지 않도록 */
        }
        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap; /* 모바일에서 줄바꿈 */
        }
        nav ul li {
            margin: 0 15px;
        }
        nav ul li button {
            background: none;
            border: none;
            color: #ecf0f1;
            font-size: 1.1em;
            padding: 10px 15px;
            cursor: pointer;
            transition: color 0.3s ease, background-color 0.3s ease, transform 0.1s ease;
            border-radius: 5px;
        }
        nav ul li button:hover {
            color: #3498db;
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        nav ul li button:active {
            transform: translateY(1px);
        }

        main {
            position: relative;
            flex-grow: 1; /* 남은 공간을 채우도록 */
            max-width: 2000px; /* 노트북 화면에 맞게 최대 너비 증가 (더 넓게) */
            margin: 20px auto;
            padding: 0 20px; /* 패딩을 main-content-wrapper가 아닌 main에 적용 */
            background-color: #2a2a2a;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            overflow: hidden; /* 섹션 전환 시 내용 잘림 방지 */
            display: flex; /* 내부 콘텐츠를 정렬하기 위해 flex 사용 */
            flex-direction: column; /* 세로 방향 정렬 */
        }
        .main-content-wrapper {
            flex-grow: 1; /* main 내에서 남은 공간을 모두 차지하도록 */
            overflow-y: auto; /* 이 부분만 스크롤 가능하도록 */
            padding-right: 15px; /* 스크롤바 공간 확보 */
            box-sizing: border-box;
            width: 100%; /* 부모의 너비를 따르도록 */
            height: 100%; /* 부모의 높이를 따르도록 (flex-grow가 더 중요) */
            padding-top: 20px; /* 상단 여백 추가 */
            padding-bottom: 20px; /* 하단 여백 추가 */

            /* 메인 차트와 정보 섹션을 가로로 나란히 배치 */
            display: flex;
            flex-wrap: wrap; /* 작은 화면에서 줄바꿈 */
            justify-content: space-around; /* 요소들 사이에 공간 배분 */
            gap: 30px; /* 요소들 사이 간격 */
        }

        /* 커스텀 스크롤바 (선택 사항) */
        .main-content-wrapper::-webkit-scrollbar {
            width: 8px;
        }
        .main-content-wrapper::-webkit-scrollbar-track {
            background: #3a3a3a;
            border-radius: 10px;
        }
        .main-content-wrapper::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 10px;
        }
        .main-content-wrapper::-webkit-scrollbar-thumb:hover {
            background: #777;
        }


        /* 메뉴를 통해 전환되는 섹션들만 absolute로 관리 */
        section {
            position: absolute; /* 이 섹션들만 absolute */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 40px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* 상단 정렬 */
            align-items: center;
            transition: transform 0.6s ease-out, opacity 0.6s ease-out;
            transform: translateX(100%);
            opacity: 0;
            z-index: 1;
            overflow-y: auto; /* 각 섹션도 내용이 길어지면 스크롤 가능하도록 */
        }
        section.active {
            transform: translateX(0);
            opacity: 1;
            z-index: 10;
        }
        section:not(.active) {
            pointer-events: none;
        }

        /* 초기 메인 섹션들 (차트와 정보)의 레이아웃 조정 */
        #mainChartSection, #infoPolicySection {
            position: static; /* absolute 해제 */
            transform: none;
            opacity: 1;
            z-index: auto;
            padding: 0; /* wrapper에 패딩이 있으므로 여기서 제거 */
            margin-bottom: 0; /* 이제 나란히 있으므로 하단 마진 제거 */
            width: calc(50% - 15px); /* main-content-wrapper의 gap 고려하여 절반씩 차지 */
            max-width: 550px; /* 각 열의 최대 너비 */
            height: auto; /* 내용에 따라 높이 자동 조절 */
            flex-shrink: 0; /* 내용이 넘칠 때 줄어들지 않도록 */
            box-sizing: border-box; /* 패딩, 보더 포함 너비 계산 */
            display: flex; /* 내부 요소 정렬을 위해 flex 사용 */
            flex-direction: column;
            align-items: center; /* 내부 콘텐츠 중앙 정렬 */
            text-align: center; /* 제목 중앙 정렬 */
        }
        #infoPolicySection {
            margin-top: 0; /* 가로 배치이므로 상단 마진 제거 */
            text-align: left; /* 텍스트는 왼쪽 정렬이 더 읽기 편함 */
        }
        #infoPolicySection h2, #mainChartSection h2 {
            margin-top: 0; /* 제목 상단 마진 제거 */
        }
        .info-content {
            width: 100%; /* 부모 너비에 맞춤 */
            max-width: none; /* 부모가 이미 max-width를 가지고 있으므로 해제 */
            text-align: left; /* 텍스트 왼쪽 정렬 */
        }


        h2 {
            color: #3498db;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }
        .chart-container {
            width: 100%; /* 부모 컨테이너에 꽉 차도록 */
            max-width: 500px; /* 차트의 최대 너비 제한 */
            height: 350px; /* 차트 높이 늘림 */
            margin: 0 auto; /* 중앙 정렬 */
            flex-shrink: 0; /* 줄어들지 않도록 */
        }
        canvas {
            background-color: #3a3a3a;
            border-radius: 8px;
        }

        /* 버튼 그룹 (기존 기능 섹션 내에서만 사용) */
        .button-group {
            width: 100%;
            max-width: 600px;
            text-align: center;
            margin-top: 20px;
        }
        .button-group button {
            background-color: #3498db;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
            margin: 5px;
        }
        .button-group button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        .button-group button:active {
            transform: translateY(1px);
        }
        .button-group button:disabled {
            background-color: #555;
            cursor: not-allowed;
            opacity: 0.6;
            transform: none;
            box-shadow: none;
        }

        .region-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        .region-buttons button {
            background-color: #2ecc71;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            min-width: 120px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            margin: 5px;
        }
        .region-buttons button:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        .region-buttons button:active {
            transform: translateY(1px);
        }

        /* 폼 요소 스타일 */
        .form-group {
            margin-bottom: 20px;
            text-align: left;
            width: 100%;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #b0b0b0;
        }
        .form-group input[type="text"],
        .form-group input[type="tel"],
        .form-group select,
        .form-group textarea,
        .form-group input[type="email"] {
            width: calc(100% - 24px);
            padding: 12px;
            border: 1px solid #555;
            border-radius: 5px;
            font-size: 1em;
            box-sizing: border-box;
            background-color: #3a3a3a;
            color: #e0e0e0;
        }
        .form-group textarea {
            resize: vertical;
        }
        .form-group select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23e0e0e0" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
            background-repeat: no-repeat;
            background-position: right 8px top 50%;
            background-size: 24px;
        }

        /* 정보 및 정책 안내 콘텐츠 스타일 */
        .info-content {
            width: 100%;
            max-width: none; /* 부모인 #infoPolicySection이 width를 설정하므로 해제 */
            text-align: left;
            margin: 0 auto;
        }
        .info-content h3 {
            color: #3498db;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .info-content p {
            margin-bottom: 15px;
        }
        .info-content ul {
            list-style: disc; /* 점 목록 */
            padding-left: 20px;
            margin-bottom: 20px;
        }
        .info-content ul li {
            margin-bottom: 8px;
            background-color: transparent; /* 배경색 제거 */
            box-shadow: none; /* 그림자 제거 */
            padding: 0; /* 패딩 제거 */
        }
        .info-content ul li a {
            color: #2ecc71; /* 링크 색상 변경 */
            text-decoration: underline;
        }
        .info-content ul li a:hover {
            color: #27ae60;
        }

        /* 추첨 결과 스타일 */
        #drawResults {
            margin-top: 20px;
            padding: 15px;
            border: 2px dashed #3498db;
            border-radius: 8px;
            text-align: center;
            background-color: #2c3e50;
            color: #ecf0f1;
            font-size: 1.3em;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
            width: 100%; /* 너비 조정 */
            max-width: 600px;
        }
        #drawResults p {
            margin: 0;
            font-weight: bold;
            color: #f1c40f;
        }

        footer {
            text-align: center;
            padding: 20px;
            margin-top: auto; /* 푸터가 항상 하단에 붙도록 */
            background-color: #34495e;
            color: #ecf0f1;
            font-size: 0.9em;
            box-shadow: 0 -4px 8px rgba(0, 0, 0, 0.3);
            flex-shrink: 0; /* 푸터가 줄어들지 않도록 */
        }

        /* 애니메이션 효과를 위한 초기 상태 */
        /* 메뉴를 통해 전환되는 섹션들만 absolute로 관리 */
        #regionSelectionSection, #supportFormSection, #dataVisualizationSelectRegionSection, #dataVisualizationSection,
        #volunteerSection, #volunteerDrawSection {
            position: absolute; /* 이 섹션들만 absolute */
            transform: translateX(100%); opacity: 0;
        }
        /* 활성화된 섹션 */
        #mainChartSection.active, #regionSelectionSection.active, #supportFormSection.active,
        #dataVisualizationSelectRegionSection.active, #dataVisualizationSection.active,
        #volunteerSection.active, #volunteerDrawSection.active {
            transform: translateX(0); opacity: 1;
        }
        /* 사라지는 섹션 */
        #mainChartSection.leaving, #regionSelectionSection.leaving, #supportFormSection.leaving,
        #dataVisualizationSelectRegionSection.leaving, #dataVisualizationSection.leaving,
        #volunteerSection.leaving, #volunteerDrawSection.leaving {
            transform: translateX(-100%); opacity: 0;
        }

        @media (max-width: 900px) { /* 900px 이하 화면에서는 세로로 다시 정렬 */
            .main-content-wrapper {
                flex-direction: column; /* 세로로 재정렬 */
                align-items: center; /* 가운데 정렬 */
                gap: 40px; /* 세로 간격 */
            }
            #mainChartSection, #infoPolicySection {
                width: 95%; /* 전체 너비의 95% 차지 */
                max-width: 600px; /* 너무 커지지 않도록 최대 너비 */
                margin-bottom: 0; /* 세로 간격은 gap이 담당 */
            }
            #infoPolicySection {
                text-align: left; /* 텍스트 정렬 유지 */
            }
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }
            .comfort-message {
                font-size: 1.2em;
            }
            nav ul li {
                margin: 5px 10px;
            }
            nav ul li button {
                font-size: 1em;
                padding: 8px 12px;
            }
            main {
                margin: 15px auto;
                padding: 0 10px; /* 모바일에서도 main 패딩 적용 */
            }
            .main-content-wrapper {
                padding-right: 10px; /* 모바일 스크롤바 공간 조정 */
                padding-top: 15px;
                padding-bottom: 15px;
            }
            section {
                padding: 20px;
            }
            h2 {
                font-size: 1.6em;
            }
            .button-group button, .support-form button {
                padding: 10px 20px;
                font-size: 1em;
            }
            .region-buttons button {
                padding: 8px 15px;
                font-size: 0.9em;
                min-width: 80px;
            }
            .chart-container {
                width: 95%;
                height: 200px;
            }
            .info-content {
                padding: 0 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>고독사 없는 따뜻한 세상</h1>
        <p class="comfort-message">
            혼자라는 생각에 지쳐있나요? 당신은 혼자가 아닙니다.<br>이웃의 따뜻한 손길이 당신을 기다립니다.
        </p>
    </header>

    <nav>
        <ul>
            <li><button onclick="changeSection('mainChartSection')">홈</button></li>
            <li><button onclick="changeSection('regionSelectionSection')">지원 신청</button></li>
            <li><button onclick="changeSection('dataVisualizationSelectRegionSection')">신청 현황</button></li>
            <li><button onclick="changeSection('volunteerSection')">자원봉사 신청</button></li>
            <li><button onclick="changeSection('volunteerDrawSection')">자원봉사자 추첨</button></li>
        </ul>
    </nav>

    <main>
        <div class="main-content-wrapper" id="homeContentWrapper">
            <section id="infoPolicySection">
                <h2>고독사 관련 정보 및 정책 안내</h2>
                <div class="info-content">
                    <h3>고독사, 왜 위험할까요?</h3>
                    <p>고독사는 단순히 혼자 죽음을 맞이하는 것을 넘어, 사회적 고립이 심화되어 발생하는 비극적인 현상입니다. 이는 정신 건강 악화(우울증, 무기력), 신체 건강 저하(질병 방치, 영양 불균형), 그리고 위급 상황 발생 시 적절한 도움을 받지 못해 생명을 잃을 수 있는 위험으로 이어집니다. 고독사는 개인의 문제가 아닌, 우리 사회 전체의 관심과 노력이 필요한 문제입니다.</p>
                    <h3>법률 및 제도 안내</h3>
                    <p>대한민국 정부는 고독사 예방을 위해 다양한 법률과 제도를 마련하고 있습니다. 주요 내용은 다음과 같습니다:</p>
                    <ul>
                        <li><a href="https://www.law.go.kr/LSW/lsInfoP.do?lsiSeq=230635&efYd=20240321#0000" target="_blank">고독사 예방 및 관리에 관한 법률</a>: 고독사 예방 및 관리에 필요한 사항을 규정하여 국민의 삶의 질 향상에 이바지함을 목적으로 합니다.</li>
                        <li><a href="https://www.bokjiro.go.kr/ssis-crg/main/html/main.do" target="_blank">복지로</a>: 다양한 복지 서비스를 한눈에 찾아보고 신청할 수 있는 정부 포털입니다. 경제적 지원, 주거 지원, 돌봄 서비스 등 필요한 정보를 얻을 수 있습니다.</li>
                        <li><a href="https://www.129.go.kr/call129/home/home.do" target="_blank">보건복지부 희망의 전화 129</a>: 24시간 운영되는 긴급 복지 상담 전화로, 위기 상황에 처한 사람들에게 신속한 지원을 제공합니다.</li>
                    </ul>
                    <h3>마음 건강 지킴이</h3>
                    <p>외로움과 고립감은 마음 건강에 큰 영향을 미칩니다. 전문가의 도움을 받는 것은 결코 부끄러운 일이 아닙니다. 다음과 같은 기관에서 심리 상담 및 정신 건강 지원을 받을 수 있습니다:</p>
                    <ul>
                        <li><a href="https://www.mentalhealth.go.kr/" target="_blank">정신건강복지센터</a>: 전국 각 지역에 위치하여 정신 건강 상담, 교육, 재활 서비스를 제공합니다.</li>
                        <li><a href="https://www.kdca.go.kr/contents.es?mid=a20504010100" target="_blank">자살예방 상담전화 1393</a>: 24시간 운영되며, 자살 위기에 처한 사람들에게 전문적인 상담을 제공합니다.</li>
                    </ul>
                    <p>당신의 소중한 삶을 지키기 위해 언제든 도움을 요청하세요. 우리는 당신 곁에 있습니다.</p>
                </div>
            </section>

            <section id="mainChartSection" class="active">
                <h2>사회적 약자 수 5년 변화 통계</h2>
                <div class="chart-container">
                    <canvas id="myChart"></canvas>
                </div>
            </section>
        </div>


        <section id="regionSelectionSection">
            <h2>지원 지역을 선택해주세요</h2>
            <div class="region-buttons">
                <button onclick="selectRegionAndProceed('강원특별자치도')">강원특별자치도</button>
                <button onclick="selectRegionAndProceed('경상북도')">경상북도</button>
                <button onclick="selectRegionAndProceed('전라남도')">전라남도</button>
                <button onclick="selectRegionAndProceed('기타 지역')">기타 지역</button>
            </div>
        </section>

        <section id="supportFormSection">
            <h2 id="selectedRegionForSupport"></h2>
            <p>어떤 도움이 필요하신가요?</p>
            <form id="supportForm">
                <div class="form-group">
                    <label for="supportType">지원 유형 선택:</label>
                    <select id="supportType" name="supportType" required>
                        <option value="">유형을 선택하세요</option>
                        <option value="불만 사항 접수">불만 사항 접수</option>
                        <option value="경제적 지원 신청">경제적 지원 신청</option>
                        <option value="취업/일자리 상담">취업/일자리 상담</option>
                        <option value="기타 상담">기타 상담</option>
                    </select>
                </div>

                <div class="form-group" id="detailInput" style="display: none;">
                    <label for="details">상세 내용 (자유롭게 작성해주세요):</label>
                    <textarea id="details" name="details" rows="5" placeholder="구체적인 내용을 작성해주시면 더 정확한 도움을 드릴 수 있습니다."></textarea>
                </div>

                <button type="submit">신청 완료</button>
            </form>
        </section>

        <section id="dataVisualizationSelectRegionSection">
            <h2>현황을 보고 싶은 도시를 선택해주세요</h2>
            <div class="region-buttons">
                <button onclick="viewApplicationChart('강원특별자치도')">강원특별자치도</button>
                <button onclick="viewApplicationChart('경상북도')">경상북도</button>
                <button onclick="viewApplicationChart('전라남도')">전라남도</button>
                <button onclick="viewApplicationChart('기타 지역')">기타 지역</button>
            </div>
        </section>

        <section id="dataVisualizationSection">
            <h2 id="applicationChartTitle"></h2>
            <div class="chart-container">
                <canvas id="applicationChart"></canvas>
            </div>
            <div class="button-group">
                <button onclick="changeSection('mainChartSection')">메인으로 돌아가기</button>
                <button onclick="changeSection('dataVisualizationSelectRegionSection')">다른 도시 현황 보기</button>
            </div>
        </section>

        <section id="volunteerSection">
            <h2>따뜻한 손길을 기다립니다</h2>
            <p>고독사 없는 사회를 만드는 데 동참해주세요.</p>
            <form id="volunteerForm" style="width: 100%; max-width: 600px;">
                <div class="form-group">
                    <label for="volunteerName">이름:</label>
                    <input type="text" id="volunteerName" name="volunteerName" required placeholder="이름을 입력해주세요">
                </div>
                <div class="form-group">
                    <label for="volunteerContact">연락처 (이메일 또는 휴대폰):</label>
                    <input type="text" id="volunteerContact" name="volunteerContact" required placeholder="연락 가능한 이메일 또는 휴대폰 번호">
                </div>
                <div class="form-group">
                    <label for="volunteerType">봉사 활동 유형:</label>
                    <select id="volunteerType" name="volunteerType" required>
                        <option value="">유형을 선택하세요</option>
                        <option value="안부 확인 전화">안부 확인 전화</option>
                        <option value="식료품/물품 배달 보조">식료품/물품 배달 보조</option>
                        <option value="말벗/정서적 지지">말벗/정서적 지지</option>
                        <option value="행정 지원 보조">행정 지원 보조</option>
                        <option value="기타">기타 (상세 내용에 작성)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="volunteerMessage">하고 싶은 말 / 상세 내용 (선택 사항):</label>
                    <textarea id="volunteerMessage" name="volunteerMessage" rows="4" placeholder="자유롭게 작성해주세요."></textarea>
                </div>
                <button type="submit">자원봉사 신청하기</button>
            </form>
            <div class="button-group">
                <button onclick="changeSection('mainChartSection')">메인으로 돌아가기</button>
            </div>
        </section>

        <section id="volunteerDrawSection">
            <h2>자원봉사자 랜덤 추첨</h2>
            <p id="volunteerCountMessage">현재 신청된 자원봉사자: <span id="currentVolunteerCount">0</span>명</p>
            <div class="button-group">
                <button id="drawButton" onclick="drawVolunteers()" disabled>2명 랜덤 추첨하기</button>
            </div>
            <div id="drawResults">
                <p>추첨 결과를 기다리는 중...</p>
            </div>
            <div class="button-group">
                <button onclick="changeSection('mainChartSection')">메인으로 돌아가기</button>
                <button onclick="resetVolunteers()">자원봉사자 목록 초기화</button>
            </div>
        </section>

    </main>

    <footer>
        <p>&copy; 2025 당신의 팀 이름. 모든 권리 보유.</p>
    </footer>

    <script>
        // 현재 활성화된 섹션 ID를 저장
        let currentActiveSectionId = 'mainChartSection';
        let currentSelectedRegionForSupport = ''; // 지원 신청 시 선택된 지역
        let currentSelectedRegionForChart = ''; // 차트 보기 시 선택된 지역

        // 신청 데이터 초기화 (LocalStorage에서 로드 또는 빈 객체)
        let allApplicationData = JSON.parse(localStorage.getItem('allApplicationData')) || {};

        // 자원봉사자 목록 (LocalStorage에 저장)
        let volunteerNames = JSON.parse(localStorage.getItem('volunteerNames')) || [];

        const SUPPORT_TYPES = ['불만 사항 접수', '경제적 지원 신청', '취업/일자리 상담', '기타 상담'];

        // 사회복지가 열악하다고 가정한 3개 지역과 기타 지역
        const POOR_WELFARE_REGIONS = ['강원특별자치도', '경상북도', '전라남도'];
        const ALL_DISPLAY_REGIONS = [...POOR_WELFARE_REGIONS, '기타 지역']; // 실제 표시될 지역 목록

        let applicationChartInstance = null; // 신청 현황 차트 인스턴스를 저장할 변수

        // 섹션 전환 함수
        function changeSection(nextSectionId) {
            const currentSection = document.getElementById(currentActiveSectionId === 'mainChartSection' ? 'homeContentWrapper' : currentActiveSectionId);
            let nextSection = document.getElementById(nextSectionId === 'mainChartSection' ? 'homeContentWrapper' : nextSectionId);

            // '홈' 버튼 클릭 시
            if (nextSectionId === 'mainChartSection') {
                // 다른 모든 absolute 섹션들을 숨김 처리
                const absoluteSections = ['regionSelectionSection', 'supportFormSection', 'dataVisualizationSelectRegionSection', 'dataVisualizationSection', 'volunteerSection', 'volunteerDrawSection'];
                absoluteSections.forEach(id => {
                    const sec = document.getElementById(id);
                    if (sec && sec.classList.contains('active')) { // 현재 활성화된 absolute 섹션만 처리
                        sec.classList.remove('active');
                        sec.classList.add('leaving'); // 왼쪽으로 사라지는 애니메이션 적용
                        sec.style.zIndex = '1';
                        setTimeout(() => {
                            sec.style.transform = 'translateX(100%)'; // 초기 상태로 되돌림
                            sec.classList.remove('leaving');
                        }, 600);
                    }
                });

                // homeContentWrapper를 활성화
                if (!nextSection.classList.contains('active')) { // 이미 활성화되어 있지 않은 경우에만 애니메이션 적용
                    nextSection.classList.add('active');
                    nextSection.style.zIndex = '10';
                    nextSection.style.transform = 'translateX(0)';
                    nextSection.style.opacity = '1';
                }
                currentActiveSectionId = nextSectionId; // 'mainChartSection'으로 currentActiveSectionId 업데이트
                return; // 함수 종료
            }

            // 홈에서 다른 absolute 섹션으로 이동할 때 homeContentWrapper를 비활성화
            if (currentActiveSectionId === 'mainChartSection') {
                const homeWrapper = document.getElementById('homeContentWrapper');
                if (homeWrapper.classList.contains('active')) { // 홈이 현재 활성화되어 있는 경우에만 처리
                    homeWrapper.classList.remove('active');
                    homeWrapper.classList.add('leaving');
                    homeWrapper.style.zIndex = '1';
                    setTimeout(() => {
                        homeWrapper.style.transform = 'translateX(-100%)'; // 홈은 왼쪽으로 사라지도록
                        homeWrapper.classList.remove('leaving');
                    }, 600);
                }
            } else {
                // 이전 absolute 섹션 비활성화
                const prevSection = document.getElementById(currentActiveSectionId);
                if (prevSection && prevSection.classList.contains('active')) { // 이전 섹션이 활성화되어 있는 경우에만 처리
                    prevSection.classList.remove('active');
                    prevSection.classList.add('leaving');
                    prevSection.style.zIndex = '1';
                    setTimeout(() => {
                        prevSection.style.transform = 'translateX(-100%)'; // 이전 섹션은 왼쪽으로 사라지도록
                        prevSection.classList.remove('leaving');
                    }, 600);
                }
            }

            // 다음 섹션 활성화 준비
            nextSection.style.transform = 'translateX(100%)';
            nextSection.style.opacity = '0';
            nextSection.classList.remove('leaving');

            // 특정 섹션으로 이동하기 전에 데이터 차트 업데이트
            if (nextSectionId === 'dataVisualizationSection') {
                updateApplicationChart();
            } else if (nextSectionId === 'volunteerDrawSection') {
                updateVolunteerDrawSection();
            }

            setTimeout(() => {
                nextSection.classList.add('active');
                nextSection.style.zIndex = '10';
                nextSection.style.transform = 'translateX(0)';
                nextSection.style.opacity = '1';

                currentActiveSectionId = nextSectionId;
            }, 600);
        }


        // 지원 신청 시 지역 선택 후 폼으로 이동
        function selectRegionAndProceed(region) {
            currentSelectedRegionForSupport = region;
            document.getElementById('selectedRegionForSupport').innerText = `${region} 지역 지원 신청`;
            changeSection('supportFormSection');
        }

        // 신청 현황 차트 보기 시 지역 선택 후 차트 섹션으로 이동
        function viewApplicationChart(region) {
            currentSelectedRegionForChart = region;
            document.getElementById('applicationChartTitle').innerText = `${region} 신청 현황 통계`;
            changeSection('dataVisualizationSection');
        }

        // 초기 사회적 약자 수 차트 그리기
        const myChartCtx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(myChartCtx, {
            type: 'bar',
            data: {
                labels: ['2019', '2020', '2021', '2022', '2023'],
                datasets: [{
                    label: '사회적 약자 수 (천 명)',
                    data: [120, 130, 145, 150, 160],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.7)',
                        'rgba(54, 162, 235, 0.7)',
                        'rgba(255, 206, 86, 0.7)',
                        'rgba(75, 192, 192, 0.7)',
                        'rgba(153, 102, 255, 0.7)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'top', labels: { color: '#e0e0e0' } },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) { label += ': '; }
                                if (context.parsed.y !== null) { label += context.parsed.y + '천 명'; }
                                return label;
                            }
                        }
                    }
                },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: '사회적 약자 수 (천 명)', color: '#e0e0e0' }, ticks: { color: '#e0e0e0' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
                    x: { title: { display: true, text: '연도', color: '#e0e0e0' }, ticks: { color: '#e0e0e0' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
                }
            }
        });

        // 신청 현황 차트 업데이트 함수 (선택된 도시에 따라 다르게 동작)
        function updateApplicationChart() {
            const appChartCtx = document.getElementById('applicationChart').getContext('2d');

            if (applicationChartInstance) {
                applicationChartInstance.destroy();
            }

            // 선택된 도시의 데이터 가져오기 (없으면 초기화된 데이터 사용)
            const dataToDisplay = allApplicationData[currentSelectedRegionForChart] || SUPPORT_TYPES.reduce((acc, type) => {
                acc[type] = 0;
                return acc;
            }, {});

            applicationChartInstance = new Chart(appChartCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(dataToDisplay),
                    datasets: [{
                        label: '신청 건수',
                        data: Object.values(dataToDisplay),
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#e0e0e0'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + '건';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // 지원 유형에 따라 상세 입력 필드 보이기/숨기기
        document.getElementById('supportType').addEventListener('change', function() {
            const detailInput = document.getElementById('detailInput');
            const detailsTextarea = document.getElementById('details');

            if (this.value === '불만 사항 접수' || this.value === '기타 상담') {
                detailInput.style.display = 'block';
                detailsTextarea.setAttribute('required', 'required');
            } else {
                detailInput.style.display = 'none';
                detailsTextarea.removeAttribute('required');
                detailsTextarea.value = '';
            }
        });

        // 폼 제출 처리 (지원 신청)
        document.getElementById('supportForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const supportType = document.getElementById('supportType').value;
            const details = document.getElementById('details').value;

            if (!currentSelectedRegionForSupport) {
                alert('지원할 지역을 먼저 선택해주세요.');
                changeSection('regionSelectionSection');
                return;
            }
            if (!supportType) {
                alert('지원 유형을 선택해주세요.');
                return;
            }

            // 해당 도시의 데이터가 없으면 초기화
            if (!allApplicationData[currentSelectedRegionForSupport]) {
                allApplicationData[currentSelectedRegionForSupport] = SUPPORT_TYPES.reduce((acc, type) => {
                    acc[type] = 0;
                    return acc;
                }, {});
            }

            // 해당 도시의 해당 유형 카운트 증가
            if (allApplicationData[currentSelectedRegionForSupport][supportType] !== undefined) {
                allApplicationData[currentSelectedRegionForSupport][supportType]++;
                localStorage.setItem('allApplicationData', JSON.stringify(allApplicationData));
            }

            console.log('--- 지원 신청 정보 ---');
            console.log('선택 지역:', currentSelectedRegionForSupport);
            console.log('지원 유형:', supportType);
            console.log('상세 내용:', details);
            console.log('업데이트된 전체 신청 데이터:', allApplicationData);
            console.log('--------------------');

            alert(`${currentSelectedRegionForSupport} 지역의 ${supportType} 신청이 성공적으로 접수되었습니다. 감사합니다!`);

            // 폼 초기화 및 메인 섹션으로 이동
            document.getElementById('supportForm').reset();
            document.getElementById('detailInput').style.display = 'none';
            currentSelectedRegionForSupport = '';
            document.getElementById('selectedRegionForSupport').innerText = '';
            changeSection('mainChartSection'); // 홈으로 돌아가기
        });

        // 폼 제출 처리 (자원봉사 신청)
        document.getElementById('volunteerForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const volunteerName = document.getElementById('volunteerName').value;
            // 연락처 정보는 LocalStorage에 저장하지 않음 (개인 정보 보호)
            // const volunteerContact = document.getElementById('volunteerContact').value;
            // const volunteerType = document.getElementById('volunteerType').value;
            // const volunteerMessage = document.getElementById('volunteerMessage').value;

            // 자원봉사자 이름만 LocalStorage에 저장
            volunteerNames.push(volunteerName);
            localStorage.setItem('volunteerNames', JSON.stringify(volunteerNames));

            console.log('--- 자원봉사 신청 정보 ---');
            console.log('이름:', volunteerName);
            console.log('현재 자원봉사자 목록:', volunteerNames);
            console.log('--------------------');

            alert(`${volunteerName} 님, 자원봉사 신청이 성공적으로 접수되었습니다. 곧 연락드리겠습니다!`);

            // 폼 초기화 및 메인 섹션으로 이동
            document.getElementById('volunteerForm').reset();
            changeSection('mainChartSection'); // 홈으로 돌아가기
        });

        // 자원봉사자 추첨 섹션 업데이트
        function updateVolunteerDrawSection() {
            const currentVolunteerCountSpan = document.getElementById('currentVolunteerCount');
            const drawButton = document.getElementById('drawButton');
            const drawResultsDiv = document.getElementById('drawResults');

            currentVolunteerCountSpan.innerText = volunteerNames.length;

            if (volunteerNames.length >= 5) {
                drawButton.disabled = false;
                drawResultsDiv.innerHTML = '<p>2명 랜덤 추첨하기 버튼을 눌러주세요!</p>';
            } else {
                drawButton.disabled = true;
                drawResultsDiv.innerHTML = `<p>자원봉사자 ${5 - volunteerNames.length}명이 더 필요합니다.</p>`;
            }
        }

        // 2명 랜덤 추첨 함수
        function drawVolunteers() {
            const drawResultsDiv = document.getElementById('drawResults');

            if (volunteerNames.length < 2) {
                drawResultsDiv.innerHTML = '<p style="color: red;">추첨할 자원봉사자가 부족합니다. (최소 2명 필요)</p>';
                return;
            }

            let tempVolunteers = [...volunteerNames];
            let selectedVolunteers = [];

            for (let i = 0; i < 2; i++) {
                if (tempVolunteers.length === 0) break;
                const randomIndex = Math.floor(Math.random() * tempVolunteers.length);
                selectedVolunteers.push(tempVolunteers[randomIndex]);
                tempVolunteers.splice(randomIndex, 1);
            }

            if (selectedVolunteers.length === 2) {
                drawResultsDiv.innerHTML = `
                    <p>축하합니다! 선정된 자원봉사자는:</p>
                    <p style="color: #f1c40f;">${selectedVolunteers[0]} 님</p>
                    <p style="color: #f1c40f;">${selectedVolunteers[1]} 님</p>
                `;
            } else {
                drawResultsDiv.innerHTML = '<p style="color: red;">추첨에 실패했습니다. 다시 시도해주세요.</p>';
            }
        }

        // 자원봉사자 목록 초기화 함수
        function resetVolunteers() {
            if (confirm('모든 자원봉사자 목록을 초기화하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                volunteerNames = [];
                localStorage.removeItem('volunteerNames');
                updateVolunteerDrawSection();
                alert('자원봉사자 목록이 초기화되었습니다.');
            }
        }

        // 페이지 로드 시 초기 자원봉사자 추첨 섹션 업데이트
        document.addEventListener('DOMContentLoaded', () => {
            // 초기에는 homeContentWrapper가 활성화되어 있도록 설정
            document.getElementById('homeContentWrapper').classList.add('active');
            document.getElementById('homeContentWrapper').style.transform = 'translateX(0)';
            document.getElementById('homeContentWrapper').style.opacity = '1';
            document.getElementById('homeContentWrapper').style.zIndex = '10';
            currentActiveSectionId = 'mainChartSection'; // 홈 섹션의 ID로 초기화

            updateVolunteerDrawSection();
        });
    </script>
</body>
</html>